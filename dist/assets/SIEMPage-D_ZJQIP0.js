const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DemoService-_OTWzG6H.js","./index-CdbTPMKZ.js","./index-CtjNbzC8.css","./triangle-alert-BoUFyv4M.js","./funnel-DKFcx2J0.js"])))=>i.map(i=>d[i]);
import{c as m,_ as v,r as o,j as e,S,B as g,T as j,k as E,K as w}from"./index-CdbTPMKZ.js";import{T as A}from"./triangle-alert-BoUFyv4M.js";import{F as L}from"./funnel-DKFcx2J0.js";const R=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],C=m("download",R);const T=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],k=m("search",T);const B=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],h=m("zap",B);class D{logs=[];listeners=[];intervalId=null;users=["SYSTEM","admin","dskum","service_account","network_service"];sources=["DC-01","WEB-01","DB-01","FW-ENT-01","IDS-01"];eventTemplates=[{id:"4624",msg:"An account was successfully logged on.",category:"Security",severity:"INFO"},{id:"4625",msg:"An account failed to log on.",category:"Security",severity:"WARN"},{id:"1102",msg:"The audit log was cleared.",category:"Security",severity:"CRITICAL"},{id:"4688",msg:"A new process has been created.",category:"System",severity:"INFO"},{id:"7045",msg:"A service was installed in the system.",category:"System",severity:"WARN"},{id:"DENY",msg:"Firewall blocked connection on port 445.",category:"Firewall",severity:"WARN"},{id:"IDS-01",msg:"Potential SQL Injection attempt detected.",category:"Application",severity:"CRITICAL"}];start(){this.intervalId||(this.intervalId=setInterval(()=>this.generateLog(),2e3))}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}subscribe(s){return this.listeners.push(s),()=>{this.listeners=this.listeners.filter(a=>a!==s)}}getInitialLogs(){return Array.from({length:20}).map(()=>this.createRandomLog())}generateLog(){const s=this.createRandomLog();this.notify(s)}createRandomLog(){const s=this.eventTemplates[Math.floor(Math.random()*this.eventTemplates.length)],a=this.sources[Math.floor(Math.random()*this.sources.length)],r=this.users[Math.floor(Math.random()*this.users.length)];return{id:Math.random().toString(36).substr(2,9),timestamp:new Date().toISOString(),severity:s.severity,source:a,eventID:s.id,message:s.msg,user:r,sourceIP:`10.0.${Math.floor(Math.random()*5)}.${Math.floor(Math.random()*255)}`,category:s.category}}addLog(s){const a={...s,id:s.id||Math.random().toString(36).substr(2,9)};this.logs.unshift(a),this.notify(a)}notify(s){this.listeners.forEach(a=>a(s))}}const n=new D;class _{async analyzeLog(s){try{{const a=await v(()=>import("./LLMService-CRRlXEqL.js"),[],import.meta.url).then(r=>r.llmService.analyzeSecurityLog(s));return{id:Math.random().toString(36).substr(2,9),relatedLogId:s.id,summary:a.summary,rootCause:a.rootCause,remediationSteps:a.remediationSteps,confidenceScore:a.confidenceScore,timestamp:new Date().toISOString()}}throw new Error("LLM Not Configured")}catch(a){console.warn("LLM Analysis failed, falling back to rule-based engine:",a),await new Promise(x=>setTimeout(x,1500));let r="",c="",i=[];return s.category==="Security"&&s.eventID==="4625"?(r=`Multiple failed login attempts detected from ${s.sourceIP}.`,c="Potential Brute Force Attack against User Account.",i=["Lock out affected user account temporarily.","Block Source IP at Firewall.","Reset User Password.","Review MFA Logs."]):s.eventID==="IDS-01"?(r=`SQL Injection signature match in HTTP Request from ${s.sourceIP}.`,c="Unsanitized input in legacy application module.",i=["Isolate web server instance.","Apply WAF Virtual Patch rule #942100.","Review application source code for query parameterization."]):s.category==="Firewall"&&s.severity==="WARN"?(r=`Port Scan detected from external IP ${s.sourceIP}.`,c="Reconnaissance activity indicating potential targeted attack.",i=["Block subnet at perimeter firewall.","Enable strict mode on IPS."]):(r=`Anomaly detected in system behavior: ${s.message}`,c="Unknown deviation from baseline.",i=["Investigate manual logs.","Escalate to Tier 2 Analyst."]),{id:Math.random().toString(36).substr(2,9),relatedLogId:s.id,summary:r,rootCause:c,remediationSteps:i,confidenceScore:.85+Math.random()*.14,timestamp:new Date().toISOString()}}}}const O=new _;function F(){const[p,s]=o.useState([]),[a,r]=o.useState(""),[c,i]=o.useState("ALL"),[x,M]=o.useState(null),[l,u]=o.useState(null),[P,I]=o.useState(!1);o.useEffect(()=>{const t=n.getInitialLogs();s(t),n.start();const d=n.subscribe(f=>{s(N=>[f,...N].slice(0,50))});return()=>{d(),n.stop()}},[]);const b=async t=>{M(t),I(!0),u(null);try{const d=await O.analyzeLog(t);u(d)}finally{I(!1)}},y=p.filter(t=>(a===""||t.message.toLowerCase().includes(a.toLowerCase())||t.eventID.includes(a))&&(c==="ALL"||t.severity===c));return e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:49:9",className:"min-h-screen pt-20 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto",children:[e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:50:13",className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:51:17",children:[e.jsx("h1",{"code-path":"src\\pages\\SIEMPage.tsx:52:21",className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-white/60",children:"Security Information & Event Management"}),e.jsxs("p",{"code-path":"src\\pages\\SIEMPage.tsx:55:21",className:"text-[#A7B1C6] font-mono text-sm mt-2 flex items-center",children:[e.jsx(S,{"code-path":"src\\pages\\SIEMPage.tsx:56:25",className:"w-4 h-4 mr-2 text-blue-500"}),"CENTRALIZED LOG AGGREGATION | RETENTION: 90 DAYS"]})]}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:60:17",className:"flex space-x-2",children:[e.jsxs(g,{"code-path":"src\\pages\\SIEMPage.tsx:61:21",variant:"outline",className:"border-red-500/50 text-red-500 hover:bg-red-500/10",onClick:()=>v(async()=>{const{demoService:t}=await import("./DemoService-_OTWzG6H.js");return{demoService:t}},__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(({demoService:t})=>t.startAttackScenario()),children:[e.jsx(h,{"code-path":"src\\pages\\SIEMPage.tsx:66:25",className:"w-4 h-4 mr-2"}),"Run Attack Demo"]}),e.jsxs(g,{"code-path":"src\\pages\\SIEMPage.tsx:69:21",variant:"outline",className:"border-white/10 text-[#A7B1C6]",children:[e.jsx(C,{"code-path":"src\\pages\\SIEMPage.tsx:70:25",className:"w-4 h-4 mr-2"}),"Export CSV"]})]})]}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:77:13",className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:78:17",className:"col-span-2 relative",children:[e.jsx(k,{"code-path":"src\\pages\\SIEMPage.tsx:79:21",className:"absolute left-3 top-2.5 h-4 w-4 text-[#A7B1C6]"}),e.jsx("input",{"code-path":"src\\pages\\SIEMPage.tsx:80:21",className:"w-full bg-white/5 border border-white/10 rounded-md pl-10 pr-4 py-2 text-sm text-white focus:outline-none focus:border-blue-500",placeholder:"Search Event ID, Message, Source...",value:a,onChange:t=>r(t.target.value)})]}),e.jsxs("select",{"code-path":"src\\pages\\SIEMPage.tsx:87:17",className:"bg-white/5 border border-white/10 rounded-md px-4 py-2 text-sm text-white focus:outline-none",value:c,onChange:t=>i(t.target.value),children:[e.jsx("option",{"code-path":"src\\pages\\SIEMPage.tsx:92:21",value:"ALL",children:"All Severities"}),e.jsx("option",{"code-path":"src\\pages\\SIEMPage.tsx:93:21",value:"INFO",children:"INFO"}),e.jsx("option",{"code-path":"src\\pages\\SIEMPage.tsx:94:21",value:"WARN",children:"WARN"}),e.jsx("option",{"code-path":"src\\pages\\SIEMPage.tsx:95:21",value:"ERROR",children:"ERROR"}),e.jsx("option",{"code-path":"src\\pages\\SIEMPage.tsx:96:21",value:"CRITICAL",children:"CRITICAL"})]}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:98:17",className:"flex items-center space-x-2 bg-white/5 border border-white/10 rounded-md px-4 justify-center",children:[e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:99:21",className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),e.jsx("span",{"code-path":"src\\pages\\SIEMPage.tsx:100:21",className:"text-xs text-[#A7B1C6] font-mono",children:"LIVE STREAMING"})]})]}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:105:13",className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:106:17",className:"bg-[#0B1628] border border-white/10 rounded-lg p-4 flex items-center space-x-4",children:[e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:107:21",className:"bg-green-500/10 p-3 rounded-full",children:e.jsx(S,{"code-path":"src\\pages\\SIEMPage.tsx:108:25",className:"w-6 h-6 text-green-500"})}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:110:21",children:[e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:111:25",className:"text-xs text-[#A7B1C6] uppercase tracking-wider",children:"NIST 800-53"}),e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:112:25",className:"text-lg font-bold text-white",children:"COMPLIANT"})]})]}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:115:17",className:"bg-[#0B1628] border border-white/10 rounded-lg p-4 flex items-center space-x-4",children:[e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:116:21",className:"bg-blue-500/10 p-3 rounded-full",children:e.jsx(j,{"code-path":"src\\pages\\SIEMPage.tsx:117:25",className:"w-6 h-6 text-blue-500"})}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:119:21",children:[e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:120:25",className:"text-xs text-[#A7B1C6] uppercase tracking-wider",children:"Log Retention"}),e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:121:25",className:"text-lg font-bold text-white",children:"90 DAYS"})]})]}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:124:17",className:"bg-[#0B1628] border border-white/10 rounded-lg p-4 flex items-center space-x-4",children:[e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:125:21",className:"bg-yellow-500/10 p-3 rounded-full",children:e.jsx(A,{"code-path":"src\\pages\\SIEMPage.tsx:126:25",className:"w-6 h-6 text-yellow-500"})}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:128:21",children:[e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:129:25",className:"text-xs text-[#A7B1C6] uppercase tracking-wider",children:"Active Threats"}),e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:130:25",className:"text-lg font-bold text-white",children:"0 CRITICAL"})]})]}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:133:17",className:"bg-[#0B1628] border border-white/10 rounded-lg p-4 flex items-center space-x-4",children:[e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:134:21",className:"bg-purple-500/10 p-3 rounded-full",children:e.jsx(L,{"code-path":"src\\pages\\SIEMPage.tsx:135:25",className:"w-6 h-6 text-purple-500"})}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:137:21",children:[e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:138:25",className:"text-xs text-[#A7B1C6] uppercase tracking-wider",children:"MITRE ATT&CK"}),e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:139:25",className:"text-lg font-bold text-white",children:"MAPPED"})]})]})]}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:145:13",className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:146:17",className:"lg:col-span-2 border border-white/10 rounded-lg overflow-hidden bg-[#050B14]",children:e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:147:21",className:"overflow-x-auto",children:e.jsxs("table",{"code-path":"src\\pages\\SIEMPage.tsx:148:25",className:"w-full text-left text-xs font-mono",children:[e.jsx("thead",{"code-path":"src\\pages\\SIEMPage.tsx:149:29",className:"bg-white/5 text-[#A7B1C6] uppercase border-b border-white/10",children:e.jsxs("tr",{"code-path":"src\\pages\\SIEMPage.tsx:150:33",children:[e.jsx("th",{"code-path":"src\\pages\\SIEMPage.tsx:151:37",className:"px-4 py-3",children:"Severity"}),e.jsx("th",{"code-path":"src\\pages\\SIEMPage.tsx:152:37",className:"px-4 py-3",children:"Event ID"}),e.jsx("th",{"code-path":"src\\pages\\SIEMPage.tsx:153:37",className:"px-4 py-3",children:"Message"}),e.jsx("th",{"code-path":"src\\pages\\SIEMPage.tsx:154:37",className:"px-4 py-3",children:"Action"})]})}),e.jsx("tbody",{"code-path":"src\\pages\\SIEMPage.tsx:157:29",className:"divide-y divide-white/5",children:y.map(t=>e.jsxs(E.tr,{"code-path":"src\\pages\\SIEMPage.tsx:159:37",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:`hover:bg-white/5 transition-colors ${x?.id===t.id?"bg-white/10 border-l-2 border-blue-500":""}`,children:[e.jsx("td",{"code-path":"src\\pages\\SIEMPage.tsx:165:41",className:"px-4 py-2",children:e.jsx("span",{"code-path":"src\\pages\\SIEMPage.tsx:166:45",className:`px-2 py-0.5 rounded text-[10px] font-bold ${t.severity==="CRITICAL"?"bg-red-500/20 text-red-500":t.severity==="ERROR"?"bg-orange-500/20 text-orange-500":t.severity==="WARN"?"bg-yellow-500/20 text-yellow-500":"bg-blue-500/20 text-blue-500"}`,children:t.severity})}),e.jsx("td",{"code-path":"src\\pages\\SIEMPage.tsx:174:41",className:"px-4 py-2 text-white",children:t.eventID}),e.jsx("td",{"code-path":"src\\pages\\SIEMPage.tsx:175:41",className:"px-4 py-2 text-white max-w-xs truncate",children:t.message}),e.jsx("td",{"code-path":"src\\pages\\SIEMPage.tsx:176:41",className:"px-4 py-2",children:e.jsx("button",{"code-path":"src\\pages\\SIEMPage.tsx:177:45",onClick:()=>b(t),className:"text-blue-400 hover:text-blue-300 underline",children:"Analyze"})})]},t.id))})]})})}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:192:17",className:"border border-white/10 rounded-lg bg-[#050B14] p-4 flex flex-col h-full",children:[e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:193:21",className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:194:25",className:"bg-purple-500/20 p-2 rounded-lg",children:e.jsx(h,{"code-path":"src\\pages\\SIEMPage.tsx:195:29",className:"w-5 h-5 text-purple-400"})}),e.jsx("h3",{"code-path":"src\\pages\\SIEMPage.tsx:197:25",className:"text-lg font-bold text-white",children:"AI Security Analyst"})]}),P?e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:201:25",className:"flex-1 flex flex-col items-center justify-center space-y-4",children:[e.jsx(w,{"code-path":"src\\pages\\SIEMPage.tsx:202:29",className:"w-8 h-8 text-purple-500 animate-spin"}),e.jsx("p",{"code-path":"src\\pages\\SIEMPage.tsx:203:29",className:"text-[#A7B1C6] animate-pulse text-xs font-mono",children:"ANALYZING THREAT VECTORS..."})]}):l?e.jsxs(E.div,{"code-path":"src\\pages\\SIEMPage.tsx:206:25",initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-4",children:[e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:211:29",className:"bg-white/5 p-3 rounded border border-white/10",children:[e.jsx("span",{"code-path":"src\\pages\\SIEMPage.tsx:212:33",className:"text-xs text-[#A7B1C6] uppercase block mb-1",children:"Root Cause"}),e.jsx("p",{"code-path":"src\\pages\\SIEMPage.tsx:213:33",className:"text-sm text-red-400 font-bold",children:l.rootCause})]}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:216:29",children:[e.jsx("span",{"code-path":"src\\pages\\SIEMPage.tsx:217:33",className:"text-xs text-[#A7B1C6] uppercase block mb-1",children:"AI Recommendation"}),e.jsx("ul",{"code-path":"src\\pages\\SIEMPage.tsx:218:33",className:"space-y-2",children:l.remediationSteps.map((t,d)=>e.jsxs("li",{"code-path":"src\\pages\\SIEMPage.tsx:220:41",className:"flex items-start text-sm text-white",children:[e.jsx("span",{"code-path":"src\\pages\\SIEMPage.tsx:221:45",className:"text-green-500 mr-2",children:"âžœ"}),t]},d))})]}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:228:29",className:"pt-4 border-t border-white/10",children:[e.jsx("span",{"code-path":"src\\pages\\SIEMPage.tsx:229:33",className:"text-xs text-[#A7B1C6] uppercase",children:"Confidence Score"}),e.jsxs("div",{"code-path":"src\\pages\\SIEMPage.tsx:230:33",className:"flex items-center space-x-2 mt-1",children:[e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:231:37",className:"flex-1 h-1 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:232:41",className:"h-full bg-purple-500",style:{width:`${l.confidenceScore*100}%`}})}),e.jsxs("span",{"code-path":"src\\pages\\SIEMPage.tsx:237:37",className:"text-xs text-purple-400 font-bold",children:[(l.confidenceScore*100).toFixed(1),"%"]})]})]}),e.jsxs(g,{"code-path":"src\\pages\\SIEMPage.tsx:243:29",className:"w-full bg-purple-600 hover:bg-purple-700 text-white",children:[e.jsx(h,{"code-path":"src\\pages\\SIEMPage.tsx:244:33",className:"w-4 h-4 mr-2"}),"Auto-Remediate"]})]}):e.jsx("div",{"code-path":"src\\pages\\SIEMPage.tsx:250:25",className:"flex-1 flex flex-col items-center justify-center text-center p-4",children:e.jsx("p",{"code-path":"src\\pages\\SIEMPage.tsx:251:29",className:"text-[#A7B1C6] text-sm",children:"Select a log entry to perform AI-driven root cause analysis and remediation."})})]})]})]})}const V=Object.freeze(Object.defineProperty({__proto__:null,SIEMPage:F},Symbol.toStringTag,{value:"Module"}));export{V as S,n as l};
